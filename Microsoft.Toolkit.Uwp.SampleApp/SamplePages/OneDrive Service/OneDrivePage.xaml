<Page
    x:Class="Microsoft.Toolkit.Uwp.SampleApp.SamplePages.OneDrivePage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Microsoft.Toolkit.Uwp.SampleApp.SamplePages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converter="using:Microsoft.Toolkit.Uwp.UI.Converters"
    xmlns:selector="using:Microsoft.Toolkit.Uwp.SampleApp.SamplePages"
    
    mc:Ignorable="d">
    <Page.Resources>
        <converter:BoolToVisibilityConverter  x:Key="VisibilityConverter"/>
        <selector:FileFolderDataTemplateSelector
                        x:Key="FileFolderDataTemplateSelector" 
                        FolderTemplate="{StaticResource FolderTemplate}"
                        FileTemplate="{StaticResource FileTemplate}"
                        NoteTemplate="{StaticResource NoteTemplate}"/>
        <DataTemplate x:Key="FolderTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48"/>
                    <ColumnDefinition Width="360"/>
                    <ColumnDefinition Width="72"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0" Grid.Column="0" 
                        Margin="0" Width="36" Height="36"                         
                        FontFamily="Segoe MDL2 Assets"
                        FontSize="36"
                        Text="" Foreground="#6D071A" 
                        HorizontalAlignment="Left" />

                <TextBlock Text="{Binding Name}"  
                           Width="auto" Height="auto"  
                           Grid.Column="1" 
                           Margin="10,0,0,0" 
                           HorizontalAlignment="Left" 
                           VerticalAlignment="Center" />
                <AppBarButton  Grid.Column="2"
                         Icon="More"
                         x:Name="cmdMenu"                            
                         Width="auto" 
                         Height="auto"
                         HorizontalAlignment="Left" 
                         VerticalAlignment="Center" 
                         Margin="0,0,0,0" 
                     >
                    <Button.Content>
                        <FontIcon x:Name="DropDownGlyph"                                   
                                  Glyph="&#xE10C;" 
                                  HorizontalAlignment="Left" 
                                  IsHitTestVisible="True" 
                                  Margin="0" 
                                  FontWeight="Bold"
                                  VerticalAlignment="Top" 
                                  FontSize="12" />
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel>
                                <!--RENAME-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Rename"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Rename"
                                         Tag="Rename"
                                         Content="Rename" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.RenameItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--DELETE-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Delete"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Delete"
                                         Content="Delete" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.DeleteItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">
                                    </AppBarButton>
                                </Grid>
                                <!--Copy to-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Copy to"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Copy"
                                         Content="Copy to" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.CopyToItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--Move to -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Move to"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="MoveToFolder"
                                         Content="Move to" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.MoveToCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </AppBarButton>

            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="FileTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48"/>
                    <ColumnDefinition Width="360"/>
                    <ColumnDefinition Width="72"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Row="0" Grid.Column="0" 
                        Margin="0" Width="36" Height="36" 
                        FontFamily="Segoe MDL2 Assets" 
                        Text="" 
                        FontSize="36"
                        Foreground="#FF0E58DA" 
                        HorizontalAlignment="Left" />

                <TextBlock Text="{Binding Name}"  
                           Width="auto" 
                           Height="auto"  
                           Grid.Column="1" 
                           Margin="10,0,0,0" 
                           HorizontalAlignment="Left" 
                           VerticalAlignment="Center">
                <ToolTipService.ToolTip>
                    <Image x:Name="ThumbNail" Source="{Binding ThumbNail}"/>
                </ToolTipService.ToolTip>
                </TextBlock>
                <AppBarButton  Grid.Column="2"
                         Icon="More"
                         x:Name="cmdMenu"                            
                         Width="auto" 
                         Height="auto"
                         HorizontalAlignment="Left" 
                         VerticalAlignment="Center" 
                         Margin="0,0,0,0" 
                     >
                    <Button.Content>
                        <FontIcon x:Name="DropDownGlyph"                                   
                                  Glyph="&#xE10C;" 
                                  HorizontalAlignment="Left" 
                                  IsHitTestVisible="True" 
                                  Margin="0" 
                                  FontWeight="Bold"
                                  VerticalAlignment="Top" 
                                  FontSize="12" />
                    </Button.Content>
                    <Button.Flyout>
                        <Flyout>
                            <StackPanel>
                                <!--RENAME-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Rename"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Rename"
                                         Content="Rename" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.RenameItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--DELETE-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Delete"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Delete"
                                         Content="Delete" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.DeleteItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--Download-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Download"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Download"
                                         Content="Download" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.DownloadItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--Copy to-->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Copy to"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="Copy"
                                         Content="Copy to" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.CopyToItemCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                                <!--Move to -->
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="48"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                                   Text="Move to"
                                                   VerticalAlignment="Center"/>
                                    <AppBarButton Grid.Column="1"                                           
                                         Icon="MoveToFolder"
                                         Content="Move to" 
                                         Command="{Binding ElementName=Root, 
                                                   Path=DataContext.MoveToCommand}"
                                                   CommandParameter="{Binding}" 
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                    </AppBarButton>
                                </Grid>
                            </StackPanel>
                        </Flyout>
                    </Button.Flyout>
                </AppBarButton>
            </Grid>
        </DataTemplate>
        <DataTemplate x:Key="NoteTemplate">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="48"/>
                    <ColumnDefinition Width="360"/>
                </Grid.ColumnDefinitions>
                <BitmapIcon Grid.Row="0" 
                        Grid.Column="0" 
                        Margin="0" 
                        Width="36" 
                        Height="36" 
                        UriSource="ms-appx:///SamplePages/OneDrive Service/OneNote.png" 
                        Foreground="BlueViolet" HorizontalAlignment="Left" />

                <TextBlock Text="{Binding Name}"  
                           Width="auto" 
                           Height="auto"  
                           Grid.Column="1" 
                           Margin="10,0,0,0" 
                           HorizontalAlignment="Left" 
                           VerticalAlignment="Center" />
            </Grid>
        </DataTemplate>
    </Page.Resources>
    <Grid Background="{StaticResource Brush-Grey-05}" x:Name="Root"
          MaxWidth="800">
        <Grid Margin="24" 
              BorderThickness="1" 
              BorderBrush="#FFCCCCCC" 
              Background="{StaticResource Brush-Grey-04}"
              CornerRadius="4">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"></RowDefinition>
                <RowDefinition></RowDefinition>
            </Grid.RowDefinitions>
            <StackPanel Orientation="Horizontal" 
                        HorizontalAlignment="Center">
                <Image Height="100" 
                       Width="100" 
                       Stretch="Uniform" 
                       Source="/SamplePages/OneDrive Service/OneDriveLogo.png" 
                       Margin="24"/>
                <Border CornerRadius="50" 
                        x:Name="ProfileImage" 
                        Height="100" 
                        Width="100" 
                        Visibility="Collapsed">
                    <Border.Background>
                        <ImageBrush Stretch="Uniform" 
                                    ImageSource="{Binding ProfileImageUrl}"/>
                    </Border.Background>
                </Border>
            </StackPanel>

            <ScrollViewer Grid.Row="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto" MinHeight="181"></RowDefinition>
                        <RowDefinition Height="52*"></RowDefinition>
                        <RowDefinition Height="309*"/>
                    </Grid.RowDefinitions>


                    <Grid   >
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Background="#FFCCCCCC">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>

                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="ClientIdExpandButton" 
                                  FontFamily="Segoe MDL2 Assets" 
                                  VerticalAlignment="Stretch" 
                                  Content="" 
                                  Click="ClientIdExpandButton_Click" />
                            <TextBlock Grid.Column="1" 
                                       Text="Azure AD v2.0 endpoint" 
                                       HorizontalAlignment="Left" 
                                       VerticalAlignment="Center" 
                                       Margin="12,6" 
                                       Foreground="{StaticResource Brush-Grey-01}" />
                        </Grid>

                        <StackPanel x:Name="ClientIdBox" 
                                    Orientation="Vertical" 
                                    Margin="24,24,24,21" 
                                    Grid.Row="1">
                            <TextBox Header="Client Id:" 
                                     x:Name="ClientId" 
                                     Margin="0,0,0,12"
                                     Text="abf8249f-eb8b-4109-a252-16859e278880"/>
                            <Button Content="Sign in" 
                                    x:Name="ConnectButton" 
                                    Click="ConnectButton_Click" 
                                    Margin="0,10,0,0" 
                                    VerticalAlignment="Bottom" 
                                    Width="75"></Button>
                            <Button Content="Sign out" 
                                    x:Name="LogOutButton" 
                                    Click="LogOutButton_Click"
                                    Margin="0,10,0,0" 
                                    VerticalAlignment="Bottom" 
                                    Width="75"></Button>
                        </StackPanel>

                    </Grid>
                    <!-- User area -->
                    <Grid Grid.Row="1" x:Name="UserBox">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Background="#FFCCCCCC">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="UserBoxExpandButton" 
                                    FontFamily="Segoe MDL2 Assets" 
                                    VerticalAlignment="Stretch" 
                                    Content="" 
                                    Click="UserBoxExpandButton_Click" />
                            <TextBlock Grid.Column="1" 
                                       Text="User" 
                                       HorizontalAlignment="Left" 
                                       VerticalAlignment="Center" 
                                       Margin="12,6" 
                                       Foreground="{StaticResource Brush-Grey-01}" />
                        </Grid>
                        <StackPanel   x:Name="UserPanel"  
                                      Grid.Row="1" 
                                      Margin="24">
                            <TextBlock Text="{Binding DisplayName}" 
                                       FontSize="20" 
                                       FontWeight="Medium"/>
                        </StackPanel>
                    </Grid>
                    <!-- Files area -->
                    <Grid Grid.Row="2" x:Name="FilesBox">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Background="#FFCCCCCC">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <Button x:Name="FilesBoxExpandButton" 
                                    FontFamily="Segoe MDL2 Assets" 
                                    VerticalAlignment="Stretch" 
                                    Content="" 
                                    Click="FilesBoxExpandButton_Click" />
                            <TextBlock Grid.Column="1" 
                                       Text="Files" 
                                       HorizontalAlignment="Left" 
                                       VerticalAlignment="Center" 
                                       Margin="12,6" 
                                       Foreground="{StaticResource Brush-Grey-01}" />
                        </Grid>
                        <StackPanel Grid.Row="1" Margin="0" x:Name="FilesPanel" >
                            <TextBox Header="#Items by page:" 
                                     x:Name="TopText" 
                                     Margin="0,0,10,0" 
                                     InputScope="Number" Height="59"/>
                            <Button Content="Get Folders and Files" 
                                    x:Name="GetFoldersAndFilesButton"  
                                    Margin="0,10,0,0" 
                                    Click="GetFoldersAndFilesButton_Click" 
                                    Width="166"></Button>
                        </StackPanel>
                    </Grid>
                    <ProgressBar                             
                            Value="{Binding UploadProgression}" 
                            x:Name="UploadProgress" 
                            Height="22" 
                            Margin="181,10,0,10" 
                            Grid.Row="3"
                            Visibility="{Binding ProgressBarVisibility, Converter={StaticResource VisibilityConverter}}"
                            Maximum="{Binding TotalSizeFile}"/>
                    <ProgressRing 
                            x:Name="progressRing" 
                            Grid.Row="3" 
                            Margin="156,15,574,17"
                            IsActive="{Binding RingActive}" />
                    <AppBarButton x:Name="backButton" Grid.Row="3"
                            Icon="Back"                            
                            Command="{Binding NavigateBackCommand}" 
                            Margin="10,0,0,0"  
                            Height="38" 
                            Width="39" RenderTransformOrigin="0.449,1.243"/>
                    <!--tool bar-->
                    <AppBarButton x:Name="menuButton" 
                                  Icon="More"
                                  Grid.Row="3" 
                                  Margin="69,0,0,0" 
                                  Height="42" 
                                  Width="39">
                        <Button.Content>
                            <FontIcon x:Name="DropDownGlyph"                                   
                                  Glyph="&#xE10C;" 
                                  HorizontalAlignment="Left" 
                                  IsHitTestVisible="True" 
                                  Margin="0" 
                                  FontWeight="Bold"
                                  VerticalAlignment="Top" 
                                  FontSize="12" />
                        </Button.Content>
                        <Button.Flyout>
                            <Flyout>
                                <StackPanel>
                                    <!--New Folder-->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="48"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   Text="New Folder"
                                                   VerticalAlignment="Center"/>
                                        <AppBarButton Grid.Column="1"                                           
                                         Icon="NewFolder"
                                         Content="New Folder" 
                                         Command="{Binding NewFolderCommand}"                                                    
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                        </AppBarButton>
                                    </Grid>

                                    <!--Upload Simple file <=4MB-->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="48"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   Text="Upload Simple File"
                                                   VerticalAlignment="Center"/>
                                        <AppBarButton Grid.Column="1"                                           
                                                      Icon="Upload"
                                         Content="Upload Simple File" 
                                         Command="{Binding SimpleItemCommand}"                                                   
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">

                                        </AppBarButton>
                                    </Grid>
                                    <!--Upload Big file >4MB-->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="48"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   Text="Upload Big File"
                                                   VerticalAlignment="Center"/>
                                        <AppBarButton Grid.Column="1"   
                                                 Icon="Upload"
                                         Content="Upload Large File" 
                                         Command="{Binding UploadBigFileCommand}"                                                   
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">
                                        </AppBarButton>
                                    </Grid>
                                    <!--Cancel Upload large File-->
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="48"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   Text="Cancel"
                                                   VerticalAlignment="Center"/>
                                        <AppBarButton Grid.Column="1"                                           
                                                      Icon="Cancel"
                                         Content="Cancel Upload Large File" 
                                         Command="{Binding CancelCommand}"                                                    
                                         VerticalAlignment="Bottom" 
                                         Width="48" Height="48">
                                        </AppBarButton>
                                    </Grid>
                                </StackPanel>
                            </Flyout>
                        </Button.Flyout>
                    </AppBarButton>
                    <ListView ItemsSource="{Binding Items}" 
                              x:Name="OneDriveItemsList" 
                              Grid.Row="4" 
                              ItemTemplateSelector="{StaticResource FileFolderDataTemplateSelector}" 
                              IsItemClickEnabled="True"
                              Margin="10,6,10,0" ItemClick="OneDriveItemsList_ItemClick">
                        <ListView.ItemsPanel>
                            <ItemsPanelTemplate>
                                <ItemsWrapGrid x:Name="itemWrapGrid" 
                                   ItemHeight="48" 
                                   ItemWidth="480" Orientation="Vertical"/>
                            </ItemsPanelTemplate>
                        </ListView.ItemsPanel>
                    </ListView>
                </Grid>
            </ScrollViewer>
        </Grid>
    </Grid>
</Page>
